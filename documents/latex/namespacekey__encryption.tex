\doxysection{key\+\_\+encryption Namespace Reference}
\hypertarget{namespacekey__encryption}{}\label{namespacekey__encryption}\index{key\_encryption@{key\_encryption}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacekey__encryption_aae51bf239682808787b2bcc9306d187b}{encrypt\+\_\+private\+\_\+key}} (private\+\_\+key, pin, progress\+\_\+callback)
\begin{DoxyCompactList}\small\item\em Encrypts a private key using AES symetric encryption, where the encryption key is the user-\/provided PIN using PBKDF2 (Password-\/\+Based Key Derivation Function 2). \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{namespacekey__encryption_aae51bf239682808787b2bcc9306d187b}\label{namespacekey__encryption_aae51bf239682808787b2bcc9306d187b} 
\index{key\_encryption@{key\_encryption}!encrypt\_private\_key@{encrypt\_private\_key}}
\index{encrypt\_private\_key@{encrypt\_private\_key}!key\_encryption@{key\_encryption}}
\doxysubsubsection{\texorpdfstring{encrypt\_private\_key()}{encrypt\_private\_key()}}
{\footnotesize\ttfamily key\+\_\+encryption.\+encrypt\+\_\+private\+\_\+key (\begin{DoxyParamCaption}\item[{}]{private\+\_\+key,  }\item[{}]{pin,  }\item[{}]{progress\+\_\+callback }\end{DoxyParamCaption})}



Encrypts a private key using AES symetric encryption, where the encryption key is the user-\/provided PIN using PBKDF2 (Password-\/\+Based Key Derivation Function 2). 

Derives a 256-\/bit AES key from a user-\/provided PIN using PBKDF2 with a 128-\/bit random salt and 600,000 iterations. The private key is encrypted using AES in EAX mode. Progress is reported via a callback messages to update the GUI to inform the user about process.

Used libraries\+:
\begin{DoxyItemize}
\item {\ttfamily pycryptodome} – for AES and PBKDF2 ({\ttfamily Crypto.\+Cipher.\+AES}, {\ttfamily Crypto.\+Protocol.\+KDF})
\item {\ttfamily os} – for secure salt generation
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em private\+\_\+key} & (bytes) The private key to encrypt. \\
\hline
{\em pin} & (str) The password used to derive the encryption key. \\
\hline
{\em progress\+\_\+callback} & (Callable\mbox{[}\mbox{[}str\mbox{]}, None\mbox{]}) A callback function to update the GUI messages.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The encrypted private key as bytes, or None if an error occurs. The resulting encrypted output is composed of\+: salt (16 bytes) + nonce (16 bytes) + authentication tag (16 bytes) + ciphertext (N bytes). 
\end{DoxyReturn}
