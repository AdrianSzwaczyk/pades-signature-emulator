<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PADES_193504_193233: verify_signature Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PADES_193504_193233
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">verify_signature Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a71c925802f3100e6a4e301e8cbafc38d" id="r_a71c925802f3100e6a4e301e8cbafc38d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a71c925802f3100e6a4e301e8cbafc38d">verify_pdf_signature</a> (pdf_path, public_key_path)</td></tr>
<tr class="memdesc:a71c925802f3100e6a4e301e8cbafc38d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify the signature of a PDF file using a public key.  <br /></td></tr>
<tr class="separator:a71c925802f3100e6a4e301e8cbafc38d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a71c925802f3100e6a4e301e8cbafc38d" name="a71c925802f3100e6a4e301e8cbafc38d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71c925802f3100e6a4e301e8cbafc38d">&#9670;&#160;</a></span>verify_pdf_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">verify_signature.verify_pdf_signature </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pdf_path</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>public_key_path</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify the signature of a PDF file using a public key. </p>
<p>This function opens and reads the PDF file with use of pypdf library, extracts metadata and checks if signature exists. If there is no data it returns False and proper error message. If the signature exists, it constructs PDF content as a text to compute the SHA256 digest and compares it with the stored digest. If those digests match, it means that the PDF has not been changed after signing with the private key. Lastly, it reads the signature as bytes from earlier retrieved metadata, imports public key from the given path, and verifies the signature using the SHA256 digest and the public key. The function uses the following libraries:</p><ul>
<li>'pypdf' for PDF parsing</li>
<li>Crypto.PublicKey.RSA, Crypto.Signature.pkcs1_15, Crypto.Hash.SHA256 from the 'pycryptodome' package for cryptographic operations.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdf_path</td><td>(str) The path to the PDF file to verify. </td></tr>
    <tr><td class="paramname">public_key_path</td><td>(str) The path to the public key file in .PEM format.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tuple[bool, str] Where the first element is a boolean indicating whether the signature is valid or invalid. Second part is a string with a message specifying the result of the verification process. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
